<div class="terminal-wrapper" (click)="onTerminalClick()" (touchstart)="onTerminalTouch($event)">
  <div class="terminal-container" #terminalContainer>
    <div class="terminal-content">
      <!-- Terminal output lines -->
      <div *ngFor="let line of lines"
           class="terminal-line"
           [ngClass]="'terminal-' + line.type">
        {{ line.text }}
      </div>

      <!-- Current input line -->
      <div class="terminal-line terminal-input-line" *ngIf="!isProcessing">
        <span class="terminal-prompt">{{ getPrompt() }}</span>
        <span class="terminal-input-display" (click)="focusInputDirect()">
          <span *ngIf="context.awaitingPassword">{{ '*'.repeat(currentInput.length) }}</span>
          <span *ngIf="!context.awaitingPassword">{{ currentInput }}</span>
          <span class="terminal-cursor" [class.blink]="showCursor">â–ˆ</span>
        </span>
      </div>

      <!-- Processing indicator -->
      <div class="terminal-line terminal-processing" *ngIf="isProcessing">
        <span class="processing-dots">...</span>
      </div>
    </div>
  </div>

  <!-- Single input field for both mobile and desktop -->
  <input
    #terminalInput
    class="terminal-input"
    [(ngModel)]="currentInput"
    (keydown)="handleInput($event)"
    [disabled]="isProcessing"
    autocomplete="off"
    autocorrect="off"
    autocapitalize="off"
    spellcheck="false"
    inputmode="text"
    enterkeyhint="send"
    [attr.type]="context.awaitingPassword ? 'password' : 'text'"
    [attr.aria-label]="context.awaitingPassword ? 'Enter password' : context.awaitingEmail ? 'Enter email' : 'Terminal input'"
  />
</div>

